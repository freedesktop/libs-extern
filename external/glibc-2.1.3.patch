*** misc/glibc-2.1.3/posix/config.h	Tue Jan 30 15:33:39 2007
--- misc/build/glibc-2.1.3/posix/config.h	Tue Jan 30 15:25:00 2007
***************
*** 1 ****
! dummy
--- 1,50 ----
! /*************************************************************************
!  *
!  *  OpenOffice.org - a multi-platform office productivity suite
!  *
!  *  $RCSfile: glibc-2.1.3.patch,v $
!  *
!  *  $Revision: 1.3 $
!  *
!  *  last change: $Author: vg $ $Date: 2007-02-06 13:23:39 $
!  *
!  *  The Contents of this file are made available subject to
!  *  the terms of GNU Lesser General Public License Version 2.1.
!  *
!  *
!  *    GNU Lesser General Public License Version 2.1
!  *    =============================================
!  *    Copyright 2005 by Sun Microsystems, Inc.
!  *    901 San Antonio Road, Palo Alto, CA 94303, USA
!  *
!  *    This library is free software; you can redistribute it and/or
!  *    modify it under the terms of the GNU Lesser General Public
!  *    License version 2.1, as published by the Free Software Foundation.
!  *
!  *    This library is distributed in the hope that it will be useful,
!  *    but WITHOUT ANY WARRANTY; without even the implied warranty of
!  *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
!  *    Lesser General Public License for more details.
!  *
!  *    You should have received a copy of the GNU Lesser General Public
!  *    License along with this library; if not, write to the Free Software
!  *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
!  *    MA  02111-1307  USA
!  *
!  ************************************************************************/
! 
! #ifdef WNT
! #include <stdlib.h>
! #define getenv getenv
! #endif
! 
! 
! #if defined(MACOSX)
! //Workaround for MACOS
! #define getopt my_neues_getopt
! #define opterr my_neues_opterr
! #define optind my_neues_optind
! #define optopt my_neues_optopt
! #endif
! 
! 
*** misc/glibc-2.1.3/posix/makefile.mk	Tue Jan 30 15:33:38 2007
--- misc/build/glibc-2.1.3/posix/makefile.mk	Tue Jan 30 15:33:27 2007
***************
*** 1 ****
! dummy
--- 1,71 ----
! #*************************************************************************
! #
! #   OpenOffice.org - a multi-platform office productivity suite
! #
! #   $RCSfile: glibc-2.1.3.patch,v $
! #
! #   $Revision: 1.3 $
! #
! #   last change: $Author: vg $ $Date: 2007-02-06 13:23:39 $
! #
! #   The Contents of this file are made available subject to
! #   the terms of GNU Lesser General Public License Version 2.1.
! #
! #
! #     GNU Lesser General Public License Version 2.1
! #     =============================================
! #     Copyright 2005 by Sun Microsystems, Inc.
! #     901 San Antonio Road, Palo Alto, CA 94303, USA
! #
! #     This library is free software; you can redistribute it and/or
! #     modify it under the terms of the GNU Lesser General Public
! #     License version 2.1, as published by the Free Software Foundation.
! #
! #     This library is distributed in the hope that it will be useful,
! #     but WITHOUT ANY WARRANTY; without even the implied warranty of
! #     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
! #     Lesser General Public License for more details.
! #
! #     You should have received a copy of the GNU Lesser General Public
! #     License along with this library; if not, write to the Free Software
! #     Foundation, Inc., 59 Temple Place, Suite 330, Boston,
! #     MA  02111-1307  USA
! #
! #*************************************************************************
! 
! PRJ=..$/..$/..$/..$/..
! 
! PRJNAME=external
! TARGET=gnu_getopt
! LIBTARGET=NO
! 
! EXTERNAL_WARNINGS_NOT_ERRORS := TRUE
! 
! SOLARINC+=-I.. 
! 
! # --- Settings -----------------------------------------------------
! 
! .INCLUDE :  settings.mk
! 
! CDEFS+=-DHAVE_STRING_H  -DHAVE_CONFIG_H
! 
! # --- Files --------------------------------------------------------
! 
! OBJFILES=	$(OBJ)$/getopt.obj		\
! 			$(OBJ)$/getopt1.obj
! 
! LIB1TARGET=$(SLB)$/$(TARGET).lib
! LIB1ARCHIV=$(LB)$/lib$(TARGET).a
! LIB1OBJFILES=$(OBJFILES)
! 
! .IF "$(OS)"=="NETBSD"
! TARGET2=gnu_readdir_r
! OBJFILES+= $(OBJ)$/readdir_r.obj
! LIB2TARGET=$(SLB)$/$(TARGET2).lib
! LIB2ARCHIV=$(LB)$/lib$(TARGET2).a
! LIB2OBJFILES= $(OBJ)$/readdir_r.obj
! .ENDIF
! 
! # --- Targets ------------------------------------------------------
! 
! .INCLUDE :  target.mk
*** misc/glibc-2.1.3/posix/readdir_r.c	Tue Jan 30 15:33:39 2007
--- misc/build/glibc-2.1.3/posix/readdir_r.c	Tue Jan 30 15:25:00 2007
***************
*** 1 ****
! dummy
--- 1,56 ----
! /* Copyright (C) 1991,92,93,94,95,96,97,98,99,2000 Free Software Foundation, Inc.
!    This file is part of the GNU C Library.
! 
!    The GNU C Library is free software; you can redistribute it and/or
!    modify it under the terms of the GNU Library General Public License as
!    published by the Free Software Foundation; either version 2 of the
!    License, or (at your option) any later version.
! 
!    The GNU C Library is distributed in the hope that it will be useful,
!    but WITHOUT ANY WARRANTY; without even the implied warranty of
!    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
!    Library General Public License for more details.
! 
!    You should have received a copy of the GNU Library General Public
!    License along with the GNU C Library; see the file COPYING.LIB.  If not,
!    write to the Free Software Foundation, Inc., 59 Temple Place - Suite 330,
!    Boston, MA 02111-1307, USA.  */
! 
! #include <errno.h>
! #include <limits.h>
! #include <stddef.h>
! #include <string.h>
! #include <dirent.h>
! #include <unistd.h>
! #include <sys/types.h>
! #include <assert.h>
! 
! #ifndef __READDIR_R
! # define __READDIR_R readdir_r
! # define DIRENT_TYPE struct dirent
! #endif
! 
! /* Read a directory entry from DIRP.  */
! int
! __READDIR_R (DIR *dirp, DIRENT_TYPE *entry, DIRENT_TYPE **result)
! {
!   DIRENT_TYPE *dp;
!   size_t reclen;
! 
!   errno = 0; 
!   /* call our non-reentrant counterpart to get the information */
!   dp = readdir(dirp);
! 
!   /* copy the result into entry */
!   if (dp != NULL) {
!     reclen = dp->d_reclen;           /* This might be NetBSD-specific 
! 				      * Add #ifdef's if anything else needed */
!     *result = memcpy(entry, dp, reclen); 
!   } else {
!     *result = NULL;
!   }
! 
!   return dp != NULL ? 0 : errno ? errno : 0; 
! }
! 
! 
